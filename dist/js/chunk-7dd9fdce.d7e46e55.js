(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7dd9fdce"],{"0299":function(t,e,n){"use strict";(function(t){var o,r=n("bd86"),i=n("795b"),a=n.n(i),c=(n("6762"),n("2fdb"),n("7f7f"),n("28a5"),n("386d"),n("dcf6")),s=n("1688"),u=n("86a8"),l=n("a00b");e["a"]=(o={props:{source:[String,Object]},mixins:[l["a"],u["a"]],components:{FluroInfiniteScroll:s["e"],FluroPagedContent:s["f"],PhotoThumbnail:c["a"]},data:function(){return{loading:!0,search:"",searchFocussed:!1,debouncedSearch:this.search}},computed:{routeKey:function(){return this.$route.name.split(".")[0]}},methods:{view:function(t){var e=this.$fluro.utils.getStringID(t);this.$router.push({query:{photo:e}})},chunked:function(e){return t.chunk(e,3)}},created:function(){},watch:{search:t.debounce(function(t){this.debouncedSearch=t},500)}},Object(r["a"])(o,"computed",{event:function(){return this.meta.item},photos:function(){return this.meta.photos},sorted:function(){return this.filtered},filtered:function(){var e=this,n=e.photos;if(!e.debouncedSearch||!e.debouncedSearch.length)return n;var o=String(e.debouncedSearch).toLowerCase().trim(),r=o.split(" ");return t.filter(n,function(e){var n=String(e.title).trim().toLowerCase(),i=t.includes(n,o);if(i)return!0;var a=n.split(" ");a=a.concat(e.keywords);var c=t.every(r,function(e){return t.some(a,function(n){return t.includes(n,e)})});return!!c||void 0})}}),Object(r["a"])(o,"asyncComputed",{meta:{default:{},get:function(){var t=this,e=t.$fluro.utils.getStringID(t.source);return t.loading=!0,new a.a(function(n,o){t.$fluro.api.get("/photos/event/".concat(e),{params:{verbose:!0,simple:"false",select:["title","managedAuthor","created","data.photographer","data.event","width","colors","height"],limit:1e4}}).then(function(e){console.log("RESOLVES",e),n(e.data),t.loading=!1},function(e){o(e),t.loading=!1})})}}}),o)}).call(this,n("2ef0"))},"11e9":function(t,e,n){var o=n("52a7"),r=n("4630"),i=n("6821"),a=n("6a99"),c=n("69a8"),s=n("c69a"),u=Object.getOwnPropertyDescriptor;e.f=n("9e1e")?u:function(t,e){if(t=i(t),e=a(e,!0),s)try{return u(t,e)}catch(n){}if(c(t,e))return r(!o.f.call(t,e),t[e])}},"2fdb":function(t,e,n){"use strict";var o=n("5ca1"),r=n("d2c8"),i="includes";o(o.P+o.F*n("5147")(i),"String",{includes:function(t){return!!~r(this,t,i).indexOf(t,arguments.length>1?arguments[1]:void 0)}})},5147:function(t,e,n){var o=n("2b4c")("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[o]=!1,!"/./"[t](e)}catch(r){}}return!0}},"52a7":function(t,e){e.f={}.propertyIsEnumerable},"5dbc":function(t,e,n){var o=n("d3f4"),r=n("8b97").set;t.exports=function(t,e,n){var i,a=e.constructor;return a!==n&&"function"==typeof a&&(i=a.prototype)!==n.prototype&&o(i)&&r&&r(t,i),t}},6762:function(t,e,n){"use strict";var o=n("5ca1"),r=n("c366")(!0);o(o.P,"Array",{includes:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),n("9c6c")("includes")},"86a8":function(t,e,n){"use strict";(function(t){n("a481"),n("20d6");e["a"]={methods:{view:function(t){var e=this.$fluro.utils.getStringID(t);this.$router.push({query:{photo:e}})},previousPhoto:function(e){var n=this,o=n.sorted||[],r=t.findIndex(o,{_id:e}),i=r;i-=1,i<0&&(i=o.length-1);var a=o[i];if(console.log("PREVIOUS",e,r,i,a,o),a){var c=n.$fluro.utils.getStringID(a);n.$router.replace({query:{photo:c}})}},nextPhoto:function(e){var n=this,o=n.sorted||[],r=t.findIndex(o,{_id:e}),i=r;i+=1,i>o.length-1&&(i=0),console.log("NEXT",e,r,i,o);var a=o[i];if(a){var c=n.$fluro.utils.getStringID(a);n.$router.replace({query:{photo:c}})}}},activated:function(){console.log("PHOTO ACTIVATED");var t=this;t.$fluro.addEventListener("previousPhoto",t.previousPhoto),t.$fluro.addEventListener("nextPhoto",t.nextPhoto)},deactivated:function(){console.log("PHOTO DEACTIVATED");var t=this;t.$fluro.removeEventListener("previousPhoto",t.previousPhoto),t.$fluro.removeEventListener("nextPhoto",t.nextPhoto)}}}).call(this,n("2ef0"))},"8b97":function(t,e,n){var o=n("d3f4"),r=n("cb7c"),i=function(t,e){if(r(t),!o(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,o){try{o=n("9b43")(Function.call,n("11e9").f(Object.prototype,"__proto__").set,2),o(t,[]),e=!(t instanceof Array)}catch(r){e=!0}return function(t,n){return i(t,n),e?t.__proto__=n:o(t,n),t}}({},!1):void 0),check:i}},9093:function(t,e,n){var o=n("ce10"),r=n("e11e").concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return o(t,r)}},"9c33":function(t,e,n){"use strict";var o=n("dcac"),r=n.n(o);r.a},aa77:function(t,e,n){var o=n("5ca1"),r=n("be13"),i=n("79e5"),a=n("fdef"),c="["+a+"]",s="​",u=RegExp("^"+c+c+"*"),l=RegExp(c+c+"*$"),h=function(t,e,n){var r={},c=i(function(){return!!a[t]()||s[t]()!=s}),u=r[t]=c?e(f):a[t];n&&(r[n]=u),o(o.P+o.F*c,"String",r)},f=h.trim=function(t,e){return t=String(r(t)),1&e&&(t=t.replace(u,"")),2&e&&(t=t.replace(l,"")),t};t.exports=h},c5f6:function(t,e,n){"use strict";var o=n("7726"),r=n("69a8"),i=n("2d95"),a=n("5dbc"),c=n("6a99"),s=n("79e5"),u=n("9093").f,l=n("11e9").f,h=n("86cc").f,f=n("aa77").trim,d="Number",p=o[d],g=p,v=p.prototype,m=i(n("2aeb")(v))==d,b="trim"in String.prototype,y=function(t){var e=c(t,!1);if("string"==typeof e&&e.length>2){e=b?e.trim():f(e,3);var n,o,r,i=e.charCodeAt(0);if(43===i||45===i){if(n=e.charCodeAt(2),88===n||120===n)return NaN}else if(48===i){switch(e.charCodeAt(1)){case 66:case 98:o=2,r=49;break;case 79:case 111:o=8,r=55;break;default:return+e}for(var a,s=e.slice(2),u=0,l=s.length;u<l;u++)if(a=s.charCodeAt(u),a<48||a>r)return NaN;return parseInt(s,o)}}return+e};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof p&&(m?s(function(){v.valueOf.call(n)}):i(n)!=d)?a(new g(y(e)),n,p):y(e)};for(var _,w=n("9e1e")?u(g):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),S=0;w.length>S;S++)r(g,_=w[S])&&!r(p,_)&&h(p,_,l(g,_));p.prototype=v,v.constructor=p,n("2aba")(o,d,p)}},cb5a:function(t,e,n){},d2ac:function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("flex-column",[t.loading?n("fluro-page-preloader",{attrs:{contain:""}}):[n("flex-column-header",[n("page-header",{attrs:{icon:"clock"},scopedSlots:t._u([{key:"left",fn:function(){return[n("h3",[t._v(t._s(t.event.title)+"\n                        "),n("span",{staticClass:"text-muted"},[t._v("\n                            / "+t._s(t._f("definitionTitle")(t.event.definition,!1,"event"))+" / "+t._s(t._f("readableEventDate")(t.event))+"\n                        ")])])]},proxy:!0},{key:"right",fn:function(){return[t.$fluro.access.can("create","photo","image")?n("v-btn",{attrs:{small:"",color:"primary",to:{name:"photos.upload.event",params:{id:t.event._id}}}},[t._v("\n                        Upload more photos\n                        "),n("fluro-icon",{attrs:{right:"",library:"fas",icon:"cloud-upload"}})],1):t._e(),n("div",{staticClass:"search",class:{active:t.searchFocussed||t.search.length}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.search,expression:"search"}],attrs:{placeholder:"Filter keywords"},domProps:{value:t.search},on:{focus:function(e){t.searchFocussed=!0},blur:function(e){t.searchFocussed=!1},input:function(e){e.target.composing||(t.search=e.target.value)}}}),n("div",{staticClass:"search-icon",on:{click:function(e){t.search=""}}},[t.search.length?n("fluro-icon",{attrs:{icon:"times"}}):n("fluro-icon",{attrs:{icon:"search"}})],1)])]},proxy:!0},{key:"rightmobile",fn:function(){},proxy:!0}])})],1),t.sorted.length?[n("flex-column-body",{attrs:{"scroll-parent":""}},[n("fluro-infinite-scroll",{attrs:{perPage:24,startPage:1,items:t.sorted},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",{staticStyle:{padding:"0 1px"}},[n("masonry",t._l(e.page,function(e){return n("brick",{attrs:{portrait:e.height>e.width}},[n("v-flex",{staticStyle:{padding:"2px",height:"100%",width:"100%"},attrs:{"d-flex":""},on:{click:function(n){return t.view(e)}}},[n("photo-thumbnail",{staticStyle:{width:"100%",height:"100%"},attrs:{image:e}})],1)],1)}),1)],1)]}}])})],1)]:[n("empty-text",{attrs:{icon:"event"}},[t.photos.length?[n("h3",[t._v("No photos")]),n("p",[t._v("No photos match your criteria")])]:[n("h3",[t._v("No photos")]),n("p",[t._v("No photos have been uploaded for this event yet.")]),t.$fluro.access.can("create","photo","image")?n("v-btn",{attrs:{color:"primary",to:{name:"photos.upload.event",params:{id:t.event._id}}}},[t._v("\n                        Upload Photos Now\n                        "),n("fluro-icon",{attrs:{right:"",library:"fas",icon:"cloud-upload"}})],1):t._e()]],2)]]],2)},r=[],i=n("0299"),a=i["a"],c=(n("9c33"),n("2877")),s=n("6544"),u=n.n(s),l=n("8336"),h=n("0e8f"),f=Object(c["a"])(a,o,r,!1,null,null,null);e["default"]=f.exports;u()(f,{VBtn:l["a"],VFlex:h["a"]})},d2c8:function(t,e,n){var o=n("aae3"),r=n("be13");t.exports=function(t,e,n){if(o(e))throw TypeError("String#"+n+" doesn't accept regex!");return String(r(t))}},db3a:function(t,e,n){"use strict";var o=n("cb5a"),r=n.n(o);r.a},dcac:function(t,e,n){},dcf6:function(t,e,n){"use strict";var o=function(){var t,e=this,n=e.$createElement,o=e._self._c||n;return o("div",{staticClass:"photo-thumbnail",class:e.classes,style:e.style},[o("div",{staticClass:"thumb-top"},[o("div",{staticClass:"thumb-left"},[e._v("\n            \n                "+e._s(e.title)+"\n                "),o("div",{staticClass:"small text-muted"},[e._v(e._s(e.date))])]),o("div",{staticClass:"thumb-right"},[o("v-btn",{attrs:{dark:"",icon:"",color:e.selected?"primary":""},on:{click:function(t){return t.stopPropagation(),e.toggleSelection()}}},[o("font-awesome-icon",{attrs:{icon:e.selectionIcon}})],1)],1)]),o("fluro-image",{attrs:{cover:"",spinner:!0,imageWidth:e.imageWidth,imageHeight:e.imageHeight,width:e.width,height:e.height,item:e.image},on:{load:e.onLoad,error:e.onError}}),o("div",{staticClass:"shader"}),o("div",{staticClass:"thumb-bottom"},[o("div",{staticClass:"thumb-left"},[e.photographer?[o("a",{on:{click:function(t){return t.stopPropagation(),e.viewPhotographer()}}},[o("fluro-avatar",{attrs:{id:e.photographer._id,left:"",type:e.photographer.style}})],1),e._v("\n                    "+e._s(e.photographer.title)+"\n                ")]:e._e()],2),o("div",{staticClass:"thumb-right"},[o("v-btn",{attrs:{dark:"",icon:""},on:{click:function(t){return t.stopPropagation(),e.download()}}},[o("font-awesome-icon",{attrs:{icon:["fas","cloud-download"]}})],1),e.user?o("v-btn",{attrs:{dark:"",icon:""},on:{click:function(t){return t.stopPropagation(),e.togglePin()}}},[o("font-awesome-icon",e._b({attrs:{icon:e.pinIcon}},"font-awesome-icon",(t={},t["spin"]=e.pinning,t),!1))],1):e._e()],1)])],1)},r=[],i=(n("c5f6"),n("cadf"),n("551c"),n("097d"),n("2ef0")),a=n.n(i),c=n("bf89"),s={props:{image:{type:Object},width:{type:Number},height:{type:Number},defaultColor:{type:String,default:"#ebeef0"}},mixins:[c["a"]],data:function(){return{loading:!0}},computed:{selectionIcon:function(){return this.selected?["fas","check"]:["far","square"]},calculatedWidth:function(){var t=this;return t.width?t.width:320},calculatedHeight:function(){var t=this;return t.aspectRatio?t.calculatedWidth*t.aspectRatio:t.height?t.height:t.calculatedWidth},imageWidth:function(){return this.calculatedWidth?this.calculatedWidth:320},imageHeight:function(){return this.calculatedHeight?this.calculatedHeight:320},classes:function(){var t=[];return this.selected&&t.push("selected"),t},selected:function(){return this.$selection.isSelected(this.image)},itemID:function(){return this.$fluro.utils.getStringID(this.image)},style:function(){return{backgroundColor:a.a.get(this.image,"colors[0]")||this.defaultColor}},title:function(){return a.a.get(this.image,"data.event.title")||a.a.get(this,"image.title")},date:function(){var t=a.a.get(this,"image.created");if(t)return this.$filters.formatDate(t,"D MMM YYYY")},photographer:function(){var t=this.image,e=a.a.get(t,"data.photographer"),n=a.a.get(t,"managedAuthor");return e&&e.title?{_id:e._id,style:"contact",title:e.title}:n&&n.title?{_id:n._id,style:"persona",title:n.title}:void 0},smallUrl:function(){return this.$fluro.asset.imageUrl(this.image,50)},url:function(){return this.$fluro.asset.imageUrl(this.image,320)},aspectRatio:function(){var t=this.image;if(t)return t.height/t.width}},methods:{toggleSelection:function(){var t={title:this.image.title,_id:this.image._id,definition:"photo",_type:"image"};this.$selection.toggle(t)},viewPhotographer:function(){var t=this.photographer._id;"contact"==this.photographer.style&&this.$router.push({name:"photographer",params:{id:t}})},download:function(){if(this.image){var t=this.$fluro.asset.downloadUrl(this.image,{filename:this.image.filename});window.open(t)}},onLoad:function(){this.loading=!1},onError:function(){this.loading=!1}}},u=s,l=(n("db3a"),n("2877")),h=n("6544"),f=n.n(h),d=n("8336"),p=Object(l["a"])(u,o,r,!1,null,"a6740bc2",null);e["a"]=p.exports;f()(p,{VBtn:d["a"]})},fdef:function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}}]);
//# sourceMappingURL=chunk-7dd9fdce.d7e46e55.js.map